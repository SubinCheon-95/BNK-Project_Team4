<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 비트코인 시세 -->
<mapper namespace="kr.co.busanbank.mapper.PriceHistoryMapper">

    <insert id="insertPrice">
        INSERT INTO PRICEHISTORY (SYMBOL, PRICE, CREATEDAT)
        VALUES (#{symbol}, #{price}, (SYSTIMESTAMP AT TIME ZONE 'Asia/Seoul'))
    </insert>

    <select id="getBtc" resultType="kr.co.busanbank.dto.PriceHistoryDTO">
        SELECT
        ID,
        SYMBOL,
        PRICE,
        CREATEDAT
        FROM PRICEHISTORY
        WHERE SYMBOL = 'BTC'
        AND CREATEDAT >= SYSTIMESTAMP - INTERVAL '1' DAY
        ORDER BY CREATEDAT ASC
    </select>

    <select id="getGold" resultType="kr.co.busanbank.dto.PriceHistoryDTO">
        SELECT
        ID,
        SYMBOL,
        PRICE,
        CREATEDAT
        FROM PRICEHISTORY
        WHERE SYMBOL = 'XAU'
        AND CREATEDAT >= SYSTIMESTAMP - INTERVAL '30' DAY
        ORDER BY CREATEDAT ASC
    </select>

    <select id="getOil" resultType="kr.co.busanbank.dto.PriceHistoryDTO">
        SELECT
        ID,
        SYMBOL,
        PRICE,
        CREATEDAT
        FROM PRICEHISTORY
        WHERE SYMBOL = 'OIL'
        AND CREATEDAT >= SYSTIMESTAMP - INTERVAL '30' DAY
        ORDER BY CREATEDAT ASC
    </select>

</mapper>